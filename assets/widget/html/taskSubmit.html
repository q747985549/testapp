<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="format-detection" content="telephone=no"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><title>Document</title></head><body><script src="../script/rem.js"></script><script src="../script/api.js"></script><script src="../script/aui-slide.js"></script><script src="../script/vue.js"></script><script src="../script/swiper.min.js"></script><script src="../script/coi.js"></script><link rel="stylesheet" href="../css/style.css"/><link rel="stylesheet" href="../css/api.css"/><link rel="stylesheet" href="../css/aui-slide.css"/><link rel="stylesheet" href="../css/swiper.min.css"/><style>body,html{height:100%;background:#8d08df url(../image/bg4.png) no-repeat;background-size:100%}.header-bottom,.header-o{background:0 0!important}.task-submit,.task-submit form .task-img img,body,html{width:100%}.task-submit form .task-img{width:4.9rem;min-height:7.06rem;background:#f4f4f4 url(../image/bg5.png) center center no-repeat;background-size:1.7rem;margin:.7rem auto 1rem}.task-submit form input[type=submit]{width:100%;height:1.1rem;background:linear-gradient(134deg,#ec008c 0%,#fc6767 100%);border-radius:.55rem;font-size:.3rem;color:#fff;outline:0}</style><div id="vm"><div class="header-o"> <div class="l" onclick="closeWin()" tapmode="tapmode"><img src="../image/jt.png"/></div><h1 id="headerTitle">提交任务</h1></div><div class="header-bottom"></div><script>function closeWin(){
    api.closeWin();
}

function openWin(url){
    api.openWin({
        name: 'test',
        url: url,
        bgColor:'#ffffff',
        pageParam: {
            name: 'test'
        }
    });
}</script><div class="task-submit mg"><form @submit.prevent="submit()"><div class="task-img" @click="getPictureType()"><img :src="imgUrl+image" alt=""/></div><input type="submit" value="提交任务"/></form></div></div><script>apiready=function(){$api.fixStatusBar($api.dom(".header-o"));new Vue({el:"#vm",data:{imgUrl:$api.imgUrl,image:""},created:function(){this.getData()},methods:{getData:function(){0==api.hasPermission({list:["photos"]})[0].granted&&api.confirm({title:"提示",msg:"是否打开读写权限,取消则不能上传图片",buttons:["确定","取消"]},function(i,a){1==i.buttonIndex&&api.requestPermission({list:["photos"],code:1},function(i,a){})})},submit:function(){$api.loading("正在提交..."),$api.ajax("/api/task/taskRefer",{image:this.image},function(i){api.toast({msg:i.msg}),$api.closeing()})},getPictureType:function(){var e=this;api.actionSheet({cancelTitle:"取消",buttons:["拍照","相册"]},function(i,a){var t=i.buttonIndex;if(3==t)return!1;e.getPicture(1==t?"camera":"library")})},getPicture:function(i){var t=this;api.getPicture({sourceType:i,encodingType:"jpg",mediaValue:"pic",destinationType:"base64",quality:70},function(i,a){if(!i||!i.base64Data)return!1;i?($api.loading("正在上传..."),t.uploadPicture(i.base64Data)):api.toast({msg:"选择失败，稍后重试"})})},uploadPicture:function(i){if(!i)return!1;var a=this;$api.ajax("/api/index/uploadImage",{base64:i},function(i){a.image=i.data.path,api.toast({msg:i.msg}),$api.closeing()})}}})},window.owin=$api.owin;</script></body></html>