<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="format-detection" content="telephone=no"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><title>Document</title></head><body><script src="../script/rem.js"></script><script src="../script/api.js"></script><script src="../script/aui-slide.js"></script><script src="../script/vue.js"></script><script src="../script/swiper.min.js"></script><script src="../script/coi.js"></script><link rel="stylesheet" href="../css/style.css"/><link rel="stylesheet" href="../css/api.css"/><link rel="stylesheet" href="../css/aui-slide.css"/><link rel="stylesheet" href="../css/swiper.min.css"/><style>body,html{width:100%;min-height:100%;background:#8d08df url(../image/bg6.png) no-repeat;background-size:100%}.header-bottom,.header-o{background:0 0!important}.details{padding-bottom:.5rem}.details .details-text{width:100%;background:rgba(255,255,255,.3);border-radius:.14rem;padding:.3rem;margin-top:.2rem;color:#fff}.details .details-text .title{width:100%;display:flex;align-items:center;justify-content:space-between;margin-bottom:.25rem}.details .details-text .title h3{font-size:.3rem;font-weight:600}.details .details-text .title span{font-size:.3rem;font-weight:600;color:#fffd45}.details .details-text h5,.details .details-text p{font-size:.26rem;line-height:.37rem}.details .details-text h5{text-align:center;margin-top:.1rem}.details h2{font-size:.34rem;color:#fff;margin:.34rem 0;text-align:center}.details,.details .details-img{width:100%}.details .details-img img{width:100%;display:block}</style><div id="vm"><div class="header-o"> <div class="l" onclick="closeWin()" tapmode="tapmode"><img src="../image/jt.png"/></div><h1 id="headerTitle">任务详情</h1></div><div class="header-bottom"></div><script>function closeWin(){
    api.closeWin();
}

function openWin(url){
    api.openWin({
        name: 'test',
        url: url,
        bgColor:'#ffffff',
        pageParam: {
            name: 'test'
        }
    });
}</script><div class="details mg"><div class="details-text"><div class="title"><h3>任务一</h3><span>{{details.draw_cn}}</span></div><p>请将以下文案及图片发布到您的朋友圈（点击图片可保存图片到手机）</p></div><div class="details-text"><p>{{details.desc}}</p><h5 @click="fubtn()">（点击复制文案）</h5></div><h2>点击图片进行保存</h2><div class="details-img" id="content" v-html="details.content"></div></div></div><script>apiready=function(){$api.fixStatusBar($api.dom(".header-o")),clipBoard=api.require("clipBoard");new Vue({el:"#vm",data:{imgUrl:$api.imgUrl,details:{}},created:function(){this.getData()},methods:{getData:function(){var i=this;0==api.hasPermission({list:["photos"]})[0].granted&&api.confirm({title:"提示",msg:"是否打开读写权限,取消则不能保存图片",buttons:["确定","取消"]},function(t,i){1==t.buttonIndex&&api.requestPermission({list:["photos"],code:1},function(t,i){})}),$api.ajax("/api/task/taskDetails",{type:1,id:api.pageParam.params.id},function(t){200==t.code&&(i.details=t.data,i.$nextTick(function(){window.domFinish()}))})},fubtn:function(){clipBoard.set({value:this.details.desc},function(t,i){t?api.toast({msg:"复制成功"}):api.toast({msg:"复制失败"})})}}})},window.domFinish=function(){var o=document.getElementById("content").getElementsByTagName("img");if(!o)return!1;for(var t=0;t<o.length;t++)!function(n){o[n].onclick=function(){api.confirm({title:"下载",msg:"是否保存图片到相册",buttons:["确定","取消"]},function(t,i){if(1==t.buttonIndex){var a="fs://"+parseInt(String(100*Math.random()))+(new Date).getTime()+".png";api.download({url:o[n].src,savePath:a,report:!0,cache:!0,allowResume:!0},function(t,i){1==t.state&&($api.loading("正在下载..."),window.saveToPhoto(a))})}})}}(t)},window.saveToPhoto=function(t){api.saveMediaToAlbum({path:t},function(t,i){t&&t.status?api.toast({msg:"保存成功"}):api.toast({msg:"保存失败请重试"}),$api.closeing()})},window.owin=$api.owin;</script></body></html>