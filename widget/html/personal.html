<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="format-detection" content="telephone=no"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><title>Document</title></head><body><script src="../script/rem.js"></script><script src="../script/api.js"></script><script src="../script/aui-slide.js"></script><script src="../script/vue.js"></script><script src="../script/swiper.min.js"></script><script src="../script/coi.js"></script><link rel="stylesheet" href="../css/style.css"/><link rel="stylesheet" href="../css/api.css"/><link rel="stylesheet" href="../css/aui-slide.css"/><link rel="stylesheet" href="../css/swiper.min.css"/><style>body,html{min-height:100%;background:#e5e5e5}.user-info-list{width:100%;padding-top:.1rem}.user-info-list li{min-height:1rem;font-size:.3rem;color:#666;display:flex;align-items:center;justify-content:space-between;box-sizing:border-box;padding:.2rem;border-bottom:1px solid #eee;background:#fff}.user-info-list .i{width:.8rem;height:.8rem;background:#eee;border-radius:50%;display:flex;overflow:hidden;align-items:center;justify-content:center}.user-info-list .i img{width:100%}.user-info-list .area{padding:.2rem;flex-direction:column}.user-info-list .area label,.user-info-list input{width:100%;display:block}.user-info-list .area textarea{margin-top:20px;width:100%;height:1.5rem;outline:0;resize:none;padding-top:10px}.user-info-list .right{width:50%;display:flex;justify-content:flex-end;align-items:center}.user-info-list input{text-align:right;min-height:.95rem;margin-right:10px;outline:0}input[type=submit]{font-size:.36rem;color:#fff;width:5.3rem;height:1rem;background:linear-gradient(134deg,#ec008c 0%,#fc6767 100%);border-radius:.5rem;margin:.5rem auto .2rem;display:block;outline:0}.border-b{border-bottom:.2rem solid #e5e5e5!important}</style><div id="vm"><div class="header-o"> <div class="l" onclick="closeWin()" tapmode="tapmode"><img src="../image/jt.png"/></div><h1 id="headerTitle">个人资料</h1></div><div class="header-bottom"></div><script>function closeWin(){
    api.closeWin();
}

function openWin(url){
    api.openWin({
        name: 'test',
        url: url,
        bgColor:'#ffffff',
        pageParam: {
            name: 'test'
        }
    });
}</script><div class="personal"><form @submit.prevent="submit()"><ul class="user-info-list"><li><label>头像</label><div class="right" @click="getPictureType()"><div class="i"><img :src="imgUrl+infoData.avatarUrl" alt=""/></div></div></li><li><label> 昵称</label><div class="right"><input type="text" v-model="infoData.nickname"/></div></li><li class="border-b"><label>手机号</label><div class="right"><input type="text" readonly="" v-model="infoData.mobile"/></div></li><li><label>收货省份</label><div class="right" @click="open()"><input type="text" readonly="" v-model="infoData.province"/><img src="../image/icons/right.png" alt=""/></div></li><li><label>收货城市</label><div class="right" @click="open()"><input type="text" readonly="" v-model="infoData.city"/><img src="../image/icons/right.png" alt=""/></div></li><li><label>收货市区</label><div class="right" @click="open()"><input type="text" readonly="" v-model="infoData.area"/><img src="../image/icons/right.png" alt=""/></div></li><li class="area"><label>详细地址(50字以内)</label><textarea placeholder="请输入详细地址(50字以内)" v-model="infoData.address" maxlength="50"></textarea></li></ul><input type="submit" value="提交"/></form></div></div><script>apiready=function(){$api.fixStatusBar($api.dom(".header-o"));var a=api.require("citySelector");new Vue({el:"#vm",data:{imgUrl:$api.imgUrl,infoData:{},isHas:0,height:api.frameHeight},created:function(){this.getData()},methods:{getData:function(){var i=this;$api.loading("正在加载..."),$api.ajax("/api/user/memberInfo",{},function(a){200==a.code&&(i.infoData=a.data),$api.closeing()})},open:function(){var i=this;i.isHas?a.show({anim:!0}):a.open({y:i.height/1.6,fixedOn:api.frameName,titleHeight:"40",cancelImg:"widget://image/cancel.png",enterImg:"widget://image/enter.png",titleImg:"widget://image/bgtitle.png",bgImg:"widget://image/bg.png",fontColor:"#999",selectedColor:"#F8526E",anim:!0},function(a){i.isHas=!0,a&&(i.infoData.province=a.province,i.infoData.city=a.city,i.infoData.area=a.county)})},submit:function(){var a={nickname:"姓名",province:"省份",city:"城市",address:"详细地址"};for(var i in a)if(!this.infoData[i])return api.toast({msg:a[i]+"不能为空"}),!1;$api.loading("正在提交..."),$api.ajax("/api/user/memberInfoEdit",this.infoData,function(a){api.toast({msg:a.msg}),api.sendEvent({name:"address",extra:{params:a.data}}),setTimeout(function(){api.closeWin()},1e3),$api.closeing()})},getPictureType:function(){var e=this;api.actionSheet({cancelTitle:"取消",buttons:["拍照","相册"]},function(a,i){var t=a.buttonIndex;if(3==t)return!1;e.getPicture(1==t?"camera":"library")})},getPicture:function(a){var t=this;api.getPicture({sourceType:a,encodingType:"jpg",mediaValue:"pic",destinationType:"base64",quality:70},function(a,i){if(!a||!a.base64Data)return!1;a?($api.loading("正在上传..."),t.uploadPicture(a.base64Data)):api.toast({msg:"选择失败，稍后重试"})})},uploadPicture:function(a){if(!a)return!1;var i=this;$api.ajax("/api/user/uploadAvatar",{base64:a},function(a){i.infoData.avatarUrl=a.data.path,api.toast({msg:a.msg}),$api.closeing()})}}})},window.owin=$api.owin;</script></body></html>